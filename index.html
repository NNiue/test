<!DOCTYPE html>
<html>
<head>
    <title>AI装修生成器</title>
    <style>
        .scroll-list {
            height: 200px;
            overflow-y: scroll;
            border: 2px solid #2A5CAA;
            margin: 20px 0;
        }
        .model-item {
            padding: 12px;
            border-bottom: 1px solid #eee;
            cursor: pointer;
        }
        .model-item.selected  {
            background: rgba(42,92,170,0.1);
            font-weight: bold;
        }
        #previewImg {
            max-width: 400px;
            border: 3px dashed #2A5CAA;
        }
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #2A5CAA;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <h1>AI装修生成器</h1>

    <!-- 模型滚动选择 -->
    <div class="scroll-list">
        <div class="model-item" onclick="selectModel('Modern_Luxe')">现代奢华风</div>
        <div class="model-item" onclick="selectModel('Scandinavian')">北欧极简风</div>
        <div class="model-item" onclick="selectModel('Industrial')">工业复古风</div>
        <div class="model-item" onclick="selectModel('Japanese_Zen')">日式禅风</div>
        <div class="model-item" onclick="selectModel('Cyberpunk')">赛博朋克风</div>
        <div class="model-item" onclick="selectModel('French_Classic')">法式经典</div>
        <div class="model-item" onclick="selectModel('Tropical')">热带度假风</div>
        <div class="model-item" onclick="selectModel('Minimalist')">极简主义</div>
        <div class="model-item" onclick="selectModel('Rustic')">乡村田园风</div>
        <div class="model-item" onclick="selectModel('Art_Deco')">装饰艺术风</div>
    </div>

    <!-- 核心功能模块 -->
    <div>
        <input type="file" id="imageUpload" accept="image/*" onchange="previewImage(event)">
        <br>
        <img id="previewImg">
    </div>

    <div style="margin:20px 0">
        <textarea id="prompt" rows="4" style="width:400px"
                  placeholder="输入装修要求，例：开放式厨房+中岛吧台+智能灯光系统..."></textarea>
    </div>

    <button onclick="generate()" id="generateBtn">
        <span id="loading"></span> 立即生成
    </button>

    <!-- 状态监控 -->
    <div id="status" style="margin-top:20px;color:#666"></div>

    <!-- 结果展示 -->
    <div id="results" style="margin-top:30px"></div>

    <script>
        const HF_API_KEY = "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";
        let selectedModel = "Modern_Luxe";

        // 模型选择
        function selectModel(model) {
            selectedModel = model;
            document.querySelectorAll('.model-item').forEach(item  => {
                item.classList.toggle('selected',  item.textContent.includes(model));
            });
        }

        // 图片预览
        function previewImage(event) {
            const reader = new FileReader();
            reader.onload  = () => {
                document.getElementById('previewImg').src  = reader.result;
            };
            reader.readAsDataURL(event.target.files[0]);
        }

        // 生成核心逻辑
        async function generate() {
            const btn = document.getElementById('generateBtn');
            const status = document.getElementById('status');
            btn.disabled  = true;
            document.getElementById('loading').className  = 'loading';

            try {
                status.textContent  = "① 正在上传图片...";
                const formData = new FormData();
                formData.append('image',  document.getElementById('imageUpload').files[0]);
                formData.append('parameters',  JSON.stringify({
                    prompt: document.getElementById('prompt').value,
                    model: selectedModel,
                    resolution: "1024x768"
                }));

                status.textContent  = "② 正在调用AI模型...";
                const response = await fetch('https://api-inference.huggingface.co/models/NNiuNUll/my-lora-platform',  {
                    headers: { Authorization: `Bearer ${HF_API_KEY}` },
                    method: 'POST',
                    body: formData
                });

                status.textContent  = "③ 渲染效果图中...";
                const result = await response.json();

                if(result.error)  throw new Error(result.error);

                // 显示结果
                document.getElementById('results').innerHTML  = result.images.map(img  => `
                    <div style="margin:10px; display:inline-block">
                        <img src="data:image/png;base64,${img}" style="width:300px; border:2px solid #ddd">
                    </div>
                `).join('');

                status.textContent  = `✅ 生成完成！共生成${result.images.length} 种方案`;

            } catch (error) {
                status.innerHTML  = `<span style="color:red">❌ 错误: ${error.message}</span>`;
                console.error(error);
            } finally {
                btn.disabled  = false;
                document.getElementById('loading').className  = '';
            }
        }
    </script>
</body>
</html>